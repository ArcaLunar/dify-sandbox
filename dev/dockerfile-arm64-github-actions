FROM python:3.10-slim

RUN apt-get update && apt-get install -y \
    pkg-config gcc libseccomp-dev \
    wget \
    && rm -rf /var/lib/apt/lists/*

RUN wget https://go.dev/dl/go1.20.6.linux-arm64.tar.gz \
    && tar -C /usr/local -xzf go1.20.6.linux-arm64.tar.gz \
    && rm go1.20.6.linux-arm64.tar.gz

RUN go mod tidy \
    && bash ./build/build_amd64.sh \
    && bash ./build/build_arm64.sh

RUN pip install httpx requests jinja2
